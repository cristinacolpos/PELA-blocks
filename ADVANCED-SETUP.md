# PELA Blocks
## Advanced Setup

All software used is free and open source . The instructions are for Windows. Linux and OSX are esssentially the same, however scripts to automate building are not provided.

## Clone and First Print

1. `git lfs install` (large file support, only needed once per computer)
1. `git clone git@github.com:LEGO-Prototypes/PELA-parametric-blocks.git`
1. **[[ Calibrate | README.md#calibrate ]]** the PELA Block models for your printer 

## Sparce Checkout (optional)

This saves time and bandwidth when the models are updated on the server.

1. `git config core.sparcecheckout true`
1. Edit `.git\info\sparce-checkout` to be:
..* `/*` 
..* `*.stl` 
..* `*.png` 
1. From now on `git pull` will ignore these files. Run `make.ps1 -stl` to create the models

## Compress and clean STL files from the command line (optional)

OpenSCAD exports large text files which benefit from cleanup and converstion to binary STL. This step is optional but can help if you Slicer complains about the file. A quick solution is to load and re-save the file generated by OpenSCAD in `3D Builder`, `Meshlab` or another editor.

Follow the instructions below if you want to this from the command line or have it done for you automatically when rebuilding the models from the command line.

1. Install **Meshlab**
1. Add to your path `C:\Program Files\VCG\MeshLab`
1. **[[ Calibrate | README.md#calibrate ]]** the PELA Block models for your printer 
1. Make and clean a single block: `PELA-block.ps1 -stl -clean l=4 w=2 h=1`
1. Make and clean a single block with technic holes: `PELA-technic-block.ps1 -stl -clean l=2 w=2 h=2`
1. Make and clean all models: `make.ps1 -stl -clean`

## Raytraced image generation (optional)

This is a work in progress and not currently recommended

1. Install **Python 3** and **PovRay**
1. `git init submodule` 
1. `git submodule update` 
1. `cd stltools`
1. `python .\setup.py build`
1. `python .\setup.py install`
1. **[[ Calibrate | README.md#calibrate ]]** the PELA Block models for your printer 
1. Make a block image: `PELA-block.ps1 -png l=4 w=2 h=1`
1. Make a block with technic features image: `PELA-technic-block.ps1 -png l=2 w=2 h=2`
1. Make all models as images: `make.ps1 -png`

## Backing Up Your Calibration Files

If you later update the PELA-blocks project to a newer version, you risk overwirting and loosing your calibration customizations. The simplest solution is to create a backup copy those settings.

1. `cd PELA-blocks`
1. `copy PELA-parameters.scad ..\PELA-parameters-backup.scad`
1. `copy PELA-print-parameters.scad ..\PELA-print-parameters-backup.scad`
